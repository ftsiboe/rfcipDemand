% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fcip_demand_sys_estimate.R
\name{fcip_demand_sys_fit}
\alias{fcip_demand_sys_fit}
\title{Build systemfit formulas and estimate the system}
\usage{
fcip_demand_sys_fit(
  data,
  fields,
  tilda_included,
  tilda_endogenous,
  tilda_excluded
)
}
\arguments{
\item{data}{Estimation \code{data.frame}/\code{data.table} containing the \code{tilda_*}
and \code{instr_*} variables referenced by the formulas.}

\item{fields}{Named list with at least \code{outcome}, \code{included},
\code{endogenous}, and optionally \code{excluded}.}

\item{tilda_included}{Character vector of residualized included regressor names
(e.g., \code{"tilda_x1"}).}

\item{tilda_endogenous}{Character vector of residualized endogenous regressor names
(e.g., \code{"tilda_z1"}).}

\item{tilda_excluded}{Character vector of instrument names (e.g., \code{"instr_z1"}),
or \code{NULL} when no excluded instruments are used.}
}
\value{
A list with elements:
\item{fit}{Fitted \code{systemfit} object.}
\item{g}{List of structural formulas.}
\item{h}{List of instrument formulas.}
}
\description{
Constructs the list of structural equations (\code{g}) and instrument sets (\code{h}),
then runs \code{systemfit()} using OLS (when no excluded instruments) or 3SLS-GMM
(when excluded instruments are present).
}
