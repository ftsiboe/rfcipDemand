% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/estimate_fcip_instruments.R
\name{estimate_fcip_instruments}
\alias{estimate_fcip_instruments}
\title{Estimate FCIP Instrumental Variables (Unloaded Rates)}
\usage{
estimate_fcip_instruments(year, statplan)
}
\arguments{
\item{year}{Integer. The target crop year for which to construct instruments.}

\item{statplan}{A data.table containing FCIP rate elements, including at least:
\describe{
\item{commodity_year}{Year of the rate observation.}
\item{state_code, county_code}{County identifiers.}
\item{commodity_code}{Crop identifier.}
\item{insured_area, lcr, contiguous_state_code, contiguous_county_code}{Fields
required by \code{estimate_fcip_unloaded_rate()}.}
}}
}
\value{
A data.table with one row per county-crop for the specified \code{year},
containing:
\describe{
\item{state_code, county_code, commodity_code}{Keys.}
\item{tau_sob}{Smoothed unloaded rate (uses contiguous-county means to fill zeros/NAs).}
\item{commodity_year}{The input \code{year}, repeated.}
}
}
\description{
Uses historical FCIP rate data to build instrumented unloaded-rate variables
following:
\enumerate{
\item Tsiboe & Turner (2023), Econometric identification of crop insurance participation
\emph{Agricultural and Resource Economics Review}, 52(3):476-497.
\url{https://doi.org/10.1017/age.2023.13}
}
}
\details{
\enumerate{
\item \strong{Task list}: Identify all unique (state, county) pairs with data in the
2-21 years before \code{year}.
\item \strong{Unloaded-rate calculation}: For each county in \code{task_list}, call
\code{estimate_fcip_unloaded_rate()} on the same 2-21 year window to get \code{tau}.
Errors return \code{NULL} so processing continues.
\item \strong{Contiguous-county smoothing}:
\itemize{
\item Build a lookup table of contiguous counties (using \code{contiguous_county}).
\item For each contiguous group, compute the mean \code{tau} to get \code{tau_c}.
}
\item \strong{Merge & fill}: Left-join the raw \code{adm} and \code{contiguous_adm};
replace any zero/NA/Inf \code{tau} with the group mean \code{tau_c} into
\code{tau_sob}.
\item \strong{Cleanup}: Drop helper columns (\code{tau}, \code{tau_c}), remove invalid rows,
add \code{commodity_year}, and return the result.
}
}
\seealso{
Other FCIP instruments: 
\code{\link{get_yu2018_instrument}()}
}
\concept{FCIP instruments}
